Discriminator
Trainable parameters: 7,737,746
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv2d'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs (thop): 53,674,673,152.0
FLOPs (fvcore): 53,674,673,152

Detailed Model Summary:
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1, 224, 224]          --
├─Sequential: 1-1                        [1, 8, 224, 224]          --
│    └─Conv2d: 2-1                       [1, 8, 224, 224]          608
│    └─ReLU: 2-2                         [1, 8, 224, 224]          --
├─Sequential: 1-2                        [1, 16, 224, 224]         --
│    └─Conv2d: 2-3                       [1, 16, 224, 224]         3,216
│    └─ReLU: 2-4                         [1, 16, 224, 224]         --
├─Sequential: 1-3                        [1, 64, 224, 224]         --
│    └─Conv2d: 2-5                       [1, 64, 224, 224]         25,664
│    └─ReLU: 2-6                         [1, 64, 224, 224]         --
├─Sequential: 1-4                        [1, 128, 224, 224]        --
│    └─Conv2d: 2-7                       [1, 128, 224, 224]        204,928
│    └─ReLU: 2-8                         [1, 128, 224, 224]        --
├─Sequential: 1-5                        [1, 128, 224, 224]        --
│    └─Conv2d: 2-9                       [1, 128, 224, 224]        409,728
│    └─ReLU: 2-10                        [1, 128, 224, 224]        --
├─Sequential: 1-6                        [1, 128, 224, 224]        --
│    └─Conv2d: 2-11                      [1, 128, 224, 224]        409,728
│    └─ReLU: 2-12                        [1, 128, 224, 224]        --
├─Sequential: 1-7                        [1, 1, 224, 224]          --
│    └─Conv2d: 2-13                      [1, 1, 224, 224]          3,201
├─Sequential: 1-8                        [1, 64, 56, 56]           --
│    └─Conv2d: 2-14                      [1, 64, 56, 56]           204,864
│    └─ReLU: 2-15                        [1, 64, 56, 56]           --
├─Sequential: 1-9                        [1, 32, 14, 14]           --
│    └─Conv2d: 2-16                      [1, 32, 14, 14]           51,232
│    └─ReLU: 2-17                        [1, 32, 14, 14]           --
├─Sequential: 1-10                       [1, 1]                    --
│    └─Linear: 2-18                      [1, 1024]                 6,423,552
│    └─Linear: 2-19                      [1, 1]                    1,025
│    └─Sigmoid: 2-20                     [1, 1]                    --
==========================================================================================
Total params: 7,737,746
Trainable params: 7,737,746
Non-trainable params: 0
Total mult-adds (G): 53.70
==========================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 191.53
Params size (MB): 30.95
Estimated Total Size (MB): 223.08
==========================================================================================
----------------------------------------------------------------------------------------------------
Generator
Trainable parameters: 158,618,683
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv2d'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.activation.ReLU'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.ConvTranspose2d'>.
[INFO] Register count_avgpool() for <class 'torch.nn.modules.pooling.AvgPool2d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register count_softmax() for <class 'torch.nn.modules.activation.Softmax'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
FLOPs (thop): 64,706,574,464.0
FLOPs (fvcore): 55,775,190,016

Detailed Model Summary:
=========================================================================================================
Layer (type:depth-idx)                                  Output Shape              Param #
=========================================================================================================
GeneratorWithTransformer                                [1, 1, 224, 224]          167,809
├─RainDropMaskDecoder: 1-1                              [1, 1, 224, 224]          200,704
│    └─Sequential: 2-1                                  [1, 196, 1024]            --
│    │    └─Rearrange: 3-1                              [1, 196, 768]             --
│    │    └─LayerNorm: 3-2                              [1, 196, 768]             1,536
│    │    └─Linear: 3-3                                 [1, 196, 1024]            787,456
│    │    └─LayerNorm: 3-4                              [1, 196, 1024]            2,048
│    └─Transformer: 2-2                                 [1, 196, 1024]            --
│    │    └─ModuleList: 3-5                             --                        151,117,824
│    │    └─LayerNorm: 3-6                              [1, 196, 1024]            2,048
│    └─Sequential: 2-3                                  [1, 1, 224, 224]          --
│    │    └─Linear: 3-7                                 [1, 196, 256]             262,400
│    │    └─Rearrange: 3-8                              [1, 1, 224, 224]          --
│    │    └─Conv2d: 3-9                                 [1, 16, 224, 224]         160
│    │    └─ReLU: 3-10                                  [1, 16, 224, 224]         --
│    │    └─Conv2d: 3-11                                [1, 1, 224, 224]          145
│    │    └─Sigmoid: 3-12                               [1, 1, 224, 224]          --
├─Sequential: 1-2                                       [1, 64, 224, 224]         --
│    └─Conv2d: 2-4                                      [1, 64, 224, 224]         6,464
│    └─ReLU: 2-5                                        [1, 64, 224, 224]         --
├─Sequential: 1-3                                       [1, 128, 112, 112]        --
│    └─Conv2d: 2-6                                      [1, 128, 112, 112]        73,856
│    └─ReLU: 2-7                                        [1, 128, 112, 112]        --
├─Sequential: 1-4                                       [1, 128, 112, 112]        --
│    └─Conv2d: 2-8                                      [1, 128, 112, 112]        147,584
│    └─ReLU: 2-9                                        [1, 128, 112, 112]        --
├─Sequential: 1-5                                       [1, 256, 56, 56]          --
│    └─Conv2d: 2-10                                     [1, 256, 56, 56]          295,168
│    └─ReLU: 2-11                                       [1, 256, 56, 56]          --
├─Sequential: 1-6                                       [1, 256, 56, 56]          --
│    └─Conv2d: 2-12                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-13                                       [1, 256, 56, 56]          --
├─Sequential: 1-7                                       [1, 256, 56, 56]          --
│    └─Conv2d: 2-14                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-15                                       [1, 256, 56, 56]          --
├─Sequential: 1-8                                       [1, 256, 56, 56]          --
│    └─Conv2d: 2-16                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-17                                       [1, 256, 56, 56]          --
├─Sequential: 1-9                                       [1, 256, 56, 56]          --
│    └─Conv2d: 2-18                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-19                                       [1, 256, 56, 56]          --
├─Sequential: 1-10                                      [1, 256, 56, 56]          --
│    └─Conv2d: 2-20                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-21                                       [1, 256, 56, 56]          --
├─Sequential: 1-11                                      [1, 256, 56, 56]          --
│    └─Conv2d: 2-22                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-23                                       [1, 256, 56, 56]          --
├─Sequential: 1-12                                      [1, 256, 56, 56]          --
│    └─Conv2d: 2-24                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-25                                       [1, 256, 56, 56]          --
├─Sequential: 1-13                                      [1, 256, 56, 56]          --
│    └─Conv2d: 2-26                                     [1, 256, 56, 56]          590,080
│    └─ReLU: 2-27                                       [1, 256, 56, 56]          --
├─Sequential: 1-14                                      [1, 3, 56, 56]            --
│    └─Conv2d: 2-28                                     [1, 3, 56, 56]            6,915
│    └─ReLU: 2-29                                       [1, 3, 56, 56]            --
├─Sequential: 1-15                                      [1, 128, 112, 112]        --
│    └─ConvTranspose2d: 2-30                            [1, 128, 112, 112]        524,416
│    └─ReflectionPad2d: 2-31                            [1, 128, 113, 113]        --
│    └─AvgPool2d: 2-32                                  [1, 128, 112, 112]        --
│    └─ReLU: 2-33                                       [1, 128, 112, 112]        --
├─Sequential: 1-16                                      [1, 128, 112, 112]        --
│    └─Conv2d: 2-34                                     [1, 128, 112, 112]        147,584
│    └─ReLU: 2-35                                       [1, 128, 112, 112]        --
├─Sequential: 1-17                                      [1, 3, 112, 112]          --
│    └─Conv2d: 2-36                                     [1, 3, 112, 112]          3,459
│    └─ReLU: 2-37                                       [1, 3, 112, 112]          --
├─Sequential: 1-18                                      [1, 64, 224, 224]         --
│    └─ConvTranspose2d: 2-38                            [1, 64, 224, 224]         131,136
│    └─ReflectionPad2d: 2-39                            [1, 64, 225, 225]         --
│    └─AvgPool2d: 2-40                                  [1, 64, 224, 224]         --
│    └─ReLU: 2-41                                       [1, 64, 224, 224]         --
├─Sequential: 1-19                                      [1, 32, 224, 224]         --
│    └─Conv2d: 2-42                                     [1, 32, 224, 224]         18,464
│    └─ReLU: 2-43                                       [1, 32, 224, 224]         --
├─Sequential: 1-20                                      [1, 3, 224, 224]          --
│    └─Conv2d: 2-44                                     [1, 3, 224, 224]          867
=========================================================================================================
Total params: 158,618,683
Trainable params: 158,618,683
Non-trainable params: 0
Total mult-adds (G): 35.04
=========================================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 400.18
Params size (MB): 633.00
Estimated Total Size (MB): 1033.78
=========================================================================================================

In testing dataset, PSNR is 26.5707 and SSIM is 0.8933 and LPIPS is 0.0829